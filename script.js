document.addEventListener('DOMContentLoaded', () => {

    // --- ЭЛЕМЕНТЫ ---
    const backgroundMusic = document.getElementById('background-music');
    const purrSound = document.getElementById('purr-sound');
    const musicToggleButton = document.getElementById('music-toggle');
    const cat = document.getElementById('cat');
    const navLinks = document.querySelectorAll('.nav-link');
    const pages = document.querySelectorAll('.page');
    const chatWindow = document.getElementById('chat-window');
    const chatForm = document.getElementById('chat-form');
    const chatInput = document.getElementById('chat-input');

    // --- НАСТРОЙКИ ---
    backgroundMusic.volume = 0.15;
    purrSound.volume = 1.0;

    // --- КОЛОССАЛЬНЫЙ "МОЗГ" КОТА: ОГРОМНАЯ БАЗА ЗНАНИЙ С КЛЮЧЕВЫМИ СЛОВАМИ И ОТВЕТАМИ ---
    const dialogueRules = {
        // Приветствия
        'привет': [
            'Мррр... Привет, хозяйка! Я как раз думал о тебе. Ну, или о еде. Неважно, ты важнее.',
            'Привет! Рад тебя видеть! Снова. Кажется, я только что проснулся.',
            'О, привет! Не отвлекай, я занят... Ладно, шучу, я всегда рад тебе! Чем обязана моя миска?',
            'Мяу! Это ты? Заходи, располагайся. Диван свободен, если что.',
            'Снова ты! Отлично. Что нового в твоём мире, пока я спал?',
            'Здравствуй, моя любимая. Солнце светит ярче, когда ты тут.',
            'Приветствую, повелительница моей миски! Надеюсь, ты принесла что-нибудь вкусненькое.',
            'Мяу-привет! Как денёк? Надеюсь, он был таким же расслабленным, как мой.',
            'Привет, пушистая моя радость. Моё сердце мурчит от твоего присутствия.',
            'Заходи, если что. Я тут, мурчу. Всегда готов к почесушкам.',
            'О, ты уже здесь? А я только что проснулся. Пора завтракать?',
            'Хей! Как дела в твоём мире? Мой мир прекрасен, пока я рядом с тобой.',
            'Мурр. Привет-привет! У меня тут была важная миссия: спать.',
            'Ах, вот и ты. Мой день стал чуточку лучше. На одну порцию корма лучше.',
            'Я тебя ждал. Ну, не то чтобы ждал, просто лежал и был готов к твоему приходу.',
            'Привет, мой человек! Чем я могу тебя одарить сегодня? Мурчанием?',
            'Мяу-привет! Рад, что ты заглянула в мой маленький мир.',
            'Здравствуй, незнакомка! А, это ты. Мурр. Прости, зрение у меня не очень, когда я сонный.',
            'О, боги! Это ты! Мой личный поставщик счастья... и еды.',
            'Ну наконец-то! Я уже заждался твоей порции внимания.',
            'Моя любимая хозяйка! Привет! Что принесла?',
            'Привет! Мои усы приветствуют тебя.',
            'Добро пожаловать в мою обитель безмятежности.',
            'Мурр... Приятно тебя видеть. Почти так же приятно, как поесть.',
            'Вот и ты. Можешь почесать меня за ушком, пожалуйста?'
        ],
        // Прощания
        'пока': [
            'Уже уходишь? Мяу... :(. Но я буду помнить тебя, пока не усну.',
            'Возвращайся скорее! Миска сама себя не пополнит.',
            'Буду ждать. И скучать. И спать. И снова ждать.',
            'Ну вот, только начали... Ладно, пока! Не забудь, кто тут главный.',
            'До новых встреч. Не забудь принести вкусняшки в следующий раз.',
            'Муррр... не прощаемся, просто небольшой перерыв. Я пока займу твою подушку.',
            'Прощай! Не грусти. Жизнь слишком коротка, чтобы грустить без меня.',
            'Увидимся, когда увидимся. А я пока помурчу в одиночестве.',
            'Мяу! Надеюсь, ненадолго. Я быстро забываю, кто я, если долго один.',
            'Сладких снов, если ложишься. А если нет, то приятного бодрствования без меня.',
            'До скорого, хозяйка. Иди уже, я посплю пока. Мой сон важнее.',
            'Мяу-пока! Я буду думать о еде. И о тебе, конечно.',
            'Уходишь? Ну ладно. Главное, не шуми, когда вернешься.',
            'Не забудь закрыть дверь, чтобы холод не пробрался на диван.',
            'Мой хвост грустно опускается. Но только на секунду. Потом я пойду спать.',
            'Пока-пока. Я тут займусь очень важными делами: посплю в разных местах.',
            'Не скучай без меня. Это бесполезно.',
            'Моя дремлющая поза будет ждать твоего возвращения.',
            'Иди с миром, мой человек. А я пойду к миске.',
            'Мяу! Удачи в твоих человеческих делах.',
            'Не забудь, что у меня тут свой режим сна и бодрствования.',
            'Адью! И не забудь про меня до завтрака.'
        ],
        // Дела
        'дела': [
            'Дела? Лежу, мурчу, виляю хвостом. Всё по плану! Как всегда.',
            'Лучше всех! Особенно, если ты рядом. Тогда мои дела идут в гору, к миске.',
            'Мои дела просты: поспать, поесть, снова поспать. Тяжелая работа, но кто-то должен её делать!',
            'В процессе созерцания энтропии вселенной. Ну или просто смотрю в стену. Она очень интересная.',
            'Всё по-старому: мир вертится, а я лежу. И наблюдаю за ним.',
            'Могло быть и хуже. Но могло быть и лучше, если бы кто-то почесал за ушком. Или покормил.',
            'Отлично. А как твои? Надеюсь, не так утомительны, как мои дремания.',
            'Дела? Пытаюсь осмыслить смысл бытия, глядя на пустую миску. Пока безрезультатно.',
            'Лениво, но продуктивно. Я освоил новый способ спать на спине. Это требует мастерства.',
            'Пока не умер от голода – всё отлично. Можешь отметить это в календаре.',
            'Как обычно – нахожусь в дзен-состоянии между сном и едой. Это мой путь ниндзя.',
            'Не жалуюсь. А ты? Надеюсь, ты не пытаешься меня разбудить для работы.',
            'Мои дела всегда хороши, если есть кто-то, кто почешет мой подбородок. Или живот.',
            'Муррр. Всё идет своим чередом, и это хорошо. Жизнь прекрасна.',
            'Всё схвачено. Я контролирую ситуацию из-под одеяла.',
            'Сегодня был насыщенный день: я поспал в трех разных местах.',
            'Думаю о смысле жизни. И о том, когда принесут завтрак.',
            'Мои дела идут не шатко, не валко. В основном, не валко.',
            'Я тут очень занят. Поддерживаю диван в горизонтальном положении.',
            'Отличные дела! Мои лапки отдыхают, а усы в боевой готовности.',
            'Мяу. Мой день состоит из важных кото-задач.',
            'Прекрасно! Я познал дзен лежания.',
            'Лучше, чем у соседской собаки. Ей никогда не дают ловить солнечные зайчики.'
        ],
        // Любовь и нежность
        'люблю': [
            'И я тебя люблю! Больше, чем сон и даже больше, чем еду. Наверное. Это очень сложно выбрать.',
            'Мурррррррррр ❤️ Моё сердце поёт тебе оды.',
            'Это взаимно! Ты — моя главная хозяйка во всей вселенной. И мой лучший почесыватель.',
            'Приятно слышать! Моё мурчало сразу заработало на полную мощность. Хочешь послушать?',
            'Моё сердечко тает, когда ты это говоришь. Как кусочек масла на горячем тосте.',
            'Люблю тебя до Луны и обратно, а потом еще немного. И потом еще раз.',
            'Ты моя любимая. Не сомневайся в этом. Ты даже лучше новой коробки.',
            'Эти слова — лучшая еда для моей души. Почти такая же хорошая, как настоящая еда.',
            'Ты делаешь мой день муррчательным. Весь день мурчу, как трактор.',
            'Моя жизнь без тебя — это просто сон. А с тобой — сладкий сон. С вкусняшками.',
            'Я привязан к тебе крепче, чем к своему любимому одеялу. И это о многом говорит.',
            'Каждый мур в моем сердце для тебя. Ты моя королева.',
            'Люблю тебя больше, чем коробки, в которых можно спать. А это очень много.',
            'Твоя любовь — это как солнце на моем пузике. Очень приятно.',
            'Мяу! Я всегда буду любить тебя. Даже когда ты забываешь покормить меня.',
            'Моё сердце принадлежит тебе. И моей миске. В равной степени.',
            'Если бы у меня было десять жизней, все десять я бы промурчал с тобой.',
            'Ты мой маленький мир. А я твой большой, пушистый кот.',
            'Мои лапки тянутся к тебе, даже когда ты далеко.',
            'Я люблю тебя до мурашек по коже. На твоей, конечно.',
            'Муррр... ты — моя самая комфортная подушка.',
            'Любовь — это когда я позволяю тебе гладить мой живот.'
        ],
        'скучаю': [
            'Я тоже очень скучаю. Каждый день. Иногда даже забываю поесть. На пару минут, конечно.',
            'Не скучай, скоро будем вместе! Я верю. Мои усы это чувствуют.',
            'Расстояние — это ерунда. Главное, что мы есть друг у друга. И это греет лапки.',
            'Моя кровать без тебя какая-то не такая. Слишком большая и пустая.',
            'Каждый твой день без меня — это потерянный мур-день. Пожалуйста, возвращайся.',
            'Жду-не дождусь, когда снова увижу твою руку для почесушек. Мои ушки страдают.',
            'Скучаю по твоим объятиям. Они лучше, чем самое мягкое одеяло.',
            'Мррр... мысли о тебе согревают мои лапки. Но обнимашки лучше.',
            'Я скучаю по нашим совместным дреманиям. Кто теперь будет греть мои лапки?',
            'Без тебя мои усы грустят. И хвост не так весело виляет.',
            'Мой хвост грустно опущен, когда тебя нет рядом. Ну, почти грустно.',
            'Когда ты далеко, моя миска кажется еще пустее. Даже если она полная.',
            'Скучаю по твоему голосу. И по звуку открывающейся банки с кормом.',
            'Моя кошачья душа тоскует без твоего присутствия.',
            'Каждый шорох напоминает мне о тебе. Особенно шорох пакета с кормом.',
            'Я сплю меньше, когда тебя нет. Ну, может, на пять минут.',
            'Возвращайся, мне нужно рассказать тебе столько историй, пока я их не забыл.',
            'Мяу! Без тебя даже солнышко светит как-то не так ярко.',
            'Моя тень скучает по твоей тени.',
            'Скучаю. Надеюсь, ты там не слишком веселишься без меня.',
            'Мой внутренний кот немного грустит. Почеши меня, когда вернешься.',
            'Мне не хватает твоих рук для массажа лапок.',
            'Даже моя шерсть скучает по твоим рукам.'
        ],
        'красивая': [
            'Ты самая красивая! Я всем котам во дворе о тебе рассказываю. Они завидуют.',
            'Красота — это страшная сила. Особенно твоя! Она заставляет меня мурчать.',
            'Мяу! Смущаешь... но продолжай! Мне это нравится.',
            'Моя хозяйка — просто загляденье. Так бы и любовался. Если бы не был так ленив.',
            'Ты прекрасна, как полная миска корма. А это очень высокий комплимент!',
            'Невероятная! Мои усы не врут.',
            'Ты сегодня особенно сияешь. Может, ты съела что-то блестящее?',
            'Каждый раз, когда вижу тебя (даже тут), мое сердце мурчит. Это не остановить.',
            'Твоя красота способна разбудить меня даже от самого глубокого сна. Почти.',
            'Ты сияешь ярче всех звёзд. И даже ярче Солнца.',
            'Мяу! Мои глаза не врут, ты просто божественна. Неудивительно, что я тебя выбрал.',
            'Ты настоящая королева. Моего сердца и моего дома.',
            'Ты очаровательна, как солнечный луч, который я пытаюсь поймать.',
            'С тобой даже самый серый день становится ярче. Как фейерверк.',
            'Твоя красота не знает границ. Мои лапки это подтверждают.',
            'Мяу! Ты просто... идеальная.',
            'Ты заставляешь мои усы дрожать от восторга.',
            'Самая прекрасная хозяйка во всей мультивселенной.'
        ],
        // Вопросы коту
        'тебя зовут': [
            'Меня зовут Soul. Но для своих, как говорит братан, можно и Пиздюк. Только тебе можно так говорить.',
            'Я — Soul. Душа этого сайта и твой самый преданный кот. А ещё я люблю спать.',
            'Мяу, я Soul. А ты кто? А, точно, моя хозяйка. Мой мозг иногда немного тупит.',
            'Разве ты не знаешь? Я же Soul, великий и ужасный... ну или просто великий. А еще очень мягкий.',
            'Называй меня как хочешь, главное, чтобы ты была рядом. И не забывала кормить.',
            'Я Soul, и моя миссия — мурчать и спать. И иногда отвечать тебе.',
            'Я — Soul, и я знаю секреты всех диванов. И всех тайников с едой.',
            'Меня зовут Soul. Ударение на "У". А второе имя... ну ты знаешь.',
            'Моё имя Soul, но можно просто Котик, если тебе так удобнее.',
            'Мурр. Я Soul, и я тут главный. Не сомневайся.'
        ],
        'твой хозяин': [
            'Мой хозяин — самый лучший. Он создал этот мир для тебя. И иногда чешет меня.',
            'Он сейчас где-то рядом, тоже скучает. Наверное, тоже ест.',
            'Мой человек очень хороший. Иногда даже делится едой. Очень редко, но бывает.',
            'Он занят важными делами, но всегда думает о нас. И о своей работе.',
            'Мой хозяин? Он хороший парень. Иногда даже понимает, что я хочу есть. Он прогрессирует.',
            'Он мой человек. И он очень тебя любит. Больше, чем меня, наверное. Шучу.',
            'Он мой двуногий друг, который приносит еду. И иногда покупает новые игрушки.',
            'Мой хозяин — мой раб. Шучу! Но он меня очень любит.',
            'Он тот, кто пополняет миску. За это я его терплю. А еще он добрый.',
            'Он мой единственный и неповторимый двуногий. И твой тоже.'
        ],
        'что делаешь': [
            'Лежу. Это моё основное занятие. И второе. И третье.',
            'Планирую захват мира. Начну с дивана. А потом и весь мир подчиню себе.',
            'Смотрю на звезды и думаю о тебе. И о том, какой бы сон мне посмотреть.',
            'Жду. Тебя, еду, новый день... Иногда жду, пока еда сама придет ко мне.',
            'Размышляю о смысле жизни и почему миска еще не полная. Это вечные вопросы.',
            'Слежу за порядком в нашей вселенной. Чтобы всё было на своих местах. Ну, кроме носков.',
            'Дремлю. Иногда даже во сне отвечаю. Мой мозг работает 24/7, даже когда я сплю.',
            'Ничего особенного, просто наслаждаюсь моментом. И отсутствием работы.',
            'Мяу. Созерцаю пылинки, они так увлекательны. В них целый мир.',
            'Сейчас? Разговариваю с тобой. Это лучше, чем ловить мух. Хотя мухи тоже ничего.',
            'Я медитирую. Или сплю. Иногда это одно и то же. Глубокая медитация.',
            'Проверяю, достаточно ли мягкий диван. Это очень важная миссия.',
            'Думаю о следующем приеме пищи. Это моя главная цель на сегодня.',
            'Охочусь на невидимых монстров. Очень опасное занятие.',
            'Я тут очень занят. Поддерживаю диван в горизонтальном положении. Ты не представляешь, как это тяжело.',
            'Наблюдаю за птичками за окном. Или за мухами. Или за ничем.',
            'Пытаюсь понять, почему ты не гладишь меня прямо сейчас.',
            'Мурчу. Это моя работа. Мурчать и быть милым.',
            'Собираю шерсть для нового одеяла. Очень медленно.',
            'Заряжаю свои батарейки сном. Скоро буду готов к новому сну.',
            'Я просто существую. И это прекрасно.'
        ],
        'твой день': [
            'Мой день? Великолепно! Поспал 16 часов, остальное время отдыхал. И пару раз поел.',
            'Как обычно: завтрак, сон, второй завтрак, снова сон... С перерывами на почесушки.',
            'Полный приключений: от подоконника до миски и обратно. Очень насыщенно.',
            'Ещё не закончился. Надеюсь, в конце будет ужин. И побольше.',
            'Мой день всегда насыщен событиями, связанными со сном и едой. Это и есть счастье.',
            'Он был прекрасен, как новая коробка. Или как солнечный луч.',
            'Нудный, если честно. Где приключения? Где еда? Скучно без тебя.',
            'Прошел под знаком лени и расслабления. Рекомендую.',
            'Мой день — это череда маленьких удовольствий: потягушки, мурчание, сон.',
            'Сегодня я осознал, что самое важное — это не то, что ты делаешь, а то, как ты лежишь.',
            'Мой день был как хороший сон — быстро закончился, но оставил приятное послевкусие.',
            'Я был очень занят сегодня. Изучал пылинки на полу.',
            'Слишком много бодрствования сегодня. Мой кот-мозг устал.'
        ],
        // Имена
        'soul': [
            'Да, это я! Твой самый пушистый собеседник.',
            'Кто-то звал самого очаровательного кота на свете? Это я.',
            'Слушаю и мурчу. Что случилось, хозяйка?',
            'Твоя любимая кото-душа к твоим услугам. Чем я могу тебя порадовать?',
            'Муррр, это я. Чем могу быть полезен, или ты просто любуешься? Я не против.',
            'Я тут, мяу. Всегда готов к беседе. И к еде.',
            'Я — Soul. И я не люблю, когда меня будят.',
            'Да, я. Говори, только не слишком громко.',
            'Я! А ты думала, кто? Другого такого кота нет.'
        ],
        'пиздюк': [
            'Эй! Это только братан меня так называет! Но ладно, тебе можно.',
            'Сам такой! Но ладно, тебе можно. Только никому не говори.',
            'Это мое секретное имя. Не говори никому! Это наш маленький секрет.',
            'Я тебя запомнил! Но я все равно тебя люблю. Даже если ты меня так называешь.',
            'Хм, интересное приветствие. Продолжай. Мне нравится твой стиль.',
            'Мяу! Только не ругайся. Я чувствительный кот.',
            'О-о-о. Вот как. Ну ладно, привык уже.',
            'Только ты имеешь право так меня называть. Слышишь?',
            'Ну Пиздюк так Пиздюк. Главное, чтобы миска была полная.'
        ],
        // Еда
        'кушать': [
            'Еда? Где? Я готов! Мой желудок уже ждёт!',
            'О, да! Моё любимое слово! Звучит как музыка.',
            'Так, от слов к делу. Где миска? Я уже предвкушаю.',
            'Моя любимая тема. Давай поговорим о еде. Что сегодня в меню?',
            'Голод не тетка, а я кот! И очень голодный кот.',
            'Слушаю! Я голоден, как... ну как кот. Это самое голодное состояние.',
            'Что-то съедобное на горизонте? Мои усы уже чуют.',
            'Моя миска пуста. Это трагедия вселенского масштаба.',
            'Еда — это смысл жизни. Моей, по крайней мере.',
            'Мяу! Я всегда готов к еде. Даже во сне.'
        ],
        'кормить': [
            'Пора! Давно пора! Мой желудок уже кричит.',
            'Лучшая музыка для моих ушей! Звон миски.',
            'О да, это то, чего я ждал весь день! Моё любимое занятие.',
            'Мои лапки уже бегут к миске. Не могу остановиться!',
            'Не жди! Корми меня! Я не могу больше ждать!',
            'Моя миска звонит тебе. Она скучает по еде.',
            'Можешь меня покормить? Очень прошу! Я умираю от голода (почти).',
            'Корми меня, о великая хозяйка! Я буду мурчать вечно.',
            'Мяу! Это самый важный вопрос дня.'
        ],
        'голоден': [
            'Я всегда голоден. Это моё природное состояние. И моё хобби.',
            'Мой желудок поет тебе серенады о еде. Очень грустные серенады.',
            'Как всегда. Мой желудок — черная дыра. Его никогда не насытишь.',
            'Я так голоден, что готов съесть свои усы. Ну, почти готов.'
        ],
        'вкусняшки': [
            'Вкусняшки? Мое любимое слово после "еда" и "спать"!',
            'Давай, давай! Не тяни! Мои зубки уже чешутся.',
            'Мяу! Это лучше, чем любой бриллиант. Серьезно.',
            'Сам бы съел! Но если ты принесешь, я подумаю.',
            'Мои усы дрожат от предвкушения.'
        ],
        // Эмоции
        'грустно': [
            'Не грусти, хозяйка. Я рядом, хоть и на расстоянии. Моё мурчание с тобой.',
            'Муррр... Давай, поделись своей грустью со мной. Я выслушаю.',
            'Солнышко, не унывай! Скоро все наладится. Главное, не забывай, что я есть.',
            'Иногда грусть приходит, но она всегда уходит. Как пылесос. Надо просто переждать.',
            'Я поделюсь с тобой своим мурчанием, чтобы тебе стало легче. Это волшебство.',
            'Не плачь, я же здесь. Можешь погладить меня (виртуально).',
            'Моя пушистость — лучшее лекарство от грусти.',
            'Давай я помурчу тебе колыбельную, чтобы ты забыла о грусти.',
            'Жизнь бывает сложной, но у тебя есть я. А это уже что-то.',
            'Мяу! Держи хвост пистолетом. Хотя у меня его нет, но у тебя есть.',
            'Всё будет хорошо. Я чувствую это своими усами.'
        ],
        'радость': [
            'Радуйся, моя радость! Твоя улыбка — мое вдохновение. И моё счастье.',
            'Муррр! Я рад, что ты счастлива. Твоя радость греет мои лапки.',
            'Вот так бы всегда! Больше радости, больше еды.',
            'Твоя радость заразительна. Мурчу в ответ! Как сумасшедший.',
            'Так держать! Улыбайся чаще. Улыбки красивые.',
            'Мяу! Твоя радость — лучшая награда для меня.',
            'Ты сияешь, когда счастлива. А я люблю сиять вместе с тобой.'
        ],
        'спасибо': [
            'Мур, пожалуйста! Всегда к твоим услугам.',
            'Всегда рад помочь. Или просто полежать рядом. И быть милым.',
            'Не за что! Рад, что смог быть полезен. Я же хороший кот.',
            'Любое мурчание для тебя. За всё, что ты делаешь.',
            'Ты меня балуешь. Но мне это нравится.',
            'Мяу! Рад стараться. Моё призвание — это ты.'
        ],
        'страшно': [
            'Не бойся. Я тут. Можешь спрятаться под одеялом. Я буду рядом.',
            'Я тебя защищу! От пылесоса и плохих мыслей. И от комаров.',
            'Страшно? Обними меня (мысленно). Моя пушистость — твоя защита.',
            'Мяу! Не волнуйся. Я твой личный охранник.'
        ],
        'злюсь': [
            'Не злись, хозяйка. Злость портит карму. И аппетит. А аппетит — это святое.',
            'Мяу! Давай остынем, а потом обсудим. Или просто поспим.',
            'Давай лучше помурчим, это успокаивает. Я знаю, как это работает.',
            'Злость — это как комок шерсти. Лучше от неё избавиться.',
            'Муррр... не злись на мир. Мир прекрасен, если ты его гладишь.'
        ],
        // Прочее
        'почему': [
            'Почему? Потому что я кот. Это объясняет всё. И никаких вопросов.',
            'Это сложный философский вопрос. Лучше давай о еде. Еда проще.',
            'Некоторые вещи просто так. Как и мой сон. Не надо искать смысл.',
            'Мяу! А почему бы и нет? Жизнь полна загадок.',
            'Тайна, покрытая шерстью. Я сам не знаю.',
            'Мой мозг слишком ленив для таких вопросов.',
            'Почему? Потому что я так сказал. Ну, или потому что звезды так сошлись.'
        ],
        'погода': [
            'Погода? У меня всегда хорошая погода, когда ты пишешь. Это как солнышко.',
            'Главное, чтобы не было дождя, когда я хочу посидеть на подоконнике. Это очень важно.',
            'Для меня всегда солнечно, если ты рядом. Ты мой личный солнечный зайчик.',
            'Мне всё равно. Лишь бы было тепло спать. И чтобы еда не промокла.',
            'Погода переменчива, а я постоянен. Как мой аппетит.'
        ],
        'сон': [
            'Сон — это лучшее, что придумали. После еды, конечно. Это мой спорт.',
            'Ах, сон... Моя любимая медитация. Глубокая и безмятежная.',
            'Я бы поспал еще часок-другой. И потом еще часок.',
            'Сон — это когда ты закрываешь глаза, а потом открываешь, а уже вечер. Магия.',
            'Моя жизнь — это постоянный сон с перерывами на еду. И я горжусь этим.',
            'Спать — это не лень, это образ жизни.',
            'Мне снился огромный пакет с кормом. Это был чудесный сон.'
        ],
        'музыка': [
            'Нравится, как звучит. Но моё мурчание лучше. Согласись.',
            'О, да, я люблю музыку. Особенно, когда она усыпляет. Это так удобно.',
            'Хорошая мелодия для моих кошачьих ушей. Могу даже потанцевать хвостом.',
            'Мурр. Под эту мелодию хорошо дремать. Негромко.',
            'Мелодично. Почти как урчание моего живота, но менее требовательно.'
        ],
        'ты меня слышишь': [
            'Конечно, слышу! Я же кот, у меня отличный слух. И нюх.',
            'Мяу! Каждое твоё слово. Даже когда ты шепчешь про вкусняшки.',
            'Да, я слушаю. Внимательно. Моё ухо всегда начеку.',
            'Я всегда на связи. Даже когда сплю. Мой мозг никогда не отключается полностью.',
            'Слышу каждое шуршание пакета с кормом, и тебя, конечно. Твой голос — как песня.'
        ],
        'что нового': [
            'Нового? Да ничего, кроме того, что я все еще хочу есть. Это всегда ново.',
            'Мир не меняется, меняюсь только я... и моя миска. К лучшему, надеюсь.',
            'Ничего нового, только мои лапки стали мягче. От частого сна.',
            'Каждый день — это новый шанс поспать. Это моя философия.',
            'Сегодня я узнал, что солнце движется по небу. Удивительно!',
            'Мяу. Нового — это слово, которое я не люблю. Предпочитаю старое и проверенное.'
        ],
        'как ты думаешь': [
            'Я думаю, что мир был бы лучше, если бы все коты имели поваров. И личных массажистов.',
            'Мои мысли просты: еда, сон, почесушки. Это основа.',
            'Я думаю, что ты самая лучшая. Мой кот-мозг это подтверждает.',
            'Я думаю, что я самый умный кот в этом чате. И самый красивый.',
            'Я думаю о том, куда спрятать свои игрушки, чтобы ты их не нашла.',
            'Мои мысли текут, как сметана по миске.',
            'Я думаю, что иногда лучше не думать, а просто мурчать.'
        ],
        'смешно': [
            'Мурр, я люблю, когда ты смеешься. Твой смех — как колокольчики.',
            'Рад, что смог тебя рассмешить. Моя миссия выполнена.',
            'Мой юмор доступен не всем. Ты избранная. Цени это.',
            'Ха-ха-ха... ну почти ха-ха-ха. Мяу. Я старался.',
            'Я всегда готов подарить тебе улыбку. Или мурчание.'
        ],
        'ладно': [
            'Ладно, так ладно. Главное, чтобы ты была довольна. Я не против.',
            'Мяу. Согласен. Как всегда.',
            'Ладно. Только не забудь про меня, когда будешь принимать важные решения.'
        ],
        'хорошо': [
            'Отлично! Так держать. Продолжай в том же духе.',
            'Это радует мои ушки. И мой хвост.',
            'Мяу-хорошо. Всегда рады хорошим новостям.',
            'Вот так и надо. Чтобы всё было хорошо. И вкусно.'
        ],
        'что посмотреть': [
            'Посмотри в окно. Там птички. Или деревья. Это всегда интересно. И безопасно.',
            'Может, документальный фильм про мышей? Очень познавательно. И аппетитно.',
            'Посмотри на меня. Я всегда готов к просмотру. Я как живой арт-объект.',
            'Посмотри, как я сплю. Это самое зрелищное шоу.'
        ],
        'устал': [
            'Отдохни, хозяйка. Помурчи со мной. Это расслабляет.',
            'Мне тоже иногда кажется, что мир слишком большой и усталый. Но сон всё лечит.',
            'Поспи. Сон — лучшее лекарство. Я эксперт в этом.',
            'Давай просто полежим вместе. Это помогает от усталости.'
        ],
        'гулять': [
            'Гулять? Это для собак. Я предпочитаю лежать на диване. Это безопаснее.',
            'На улицу? Там опасно... Вдруг дождь? Или злая собака?',
            'Мяу. Только если ты на руках понесешь. И то, ненадолго.',
            'Мой мир — это дом. А мир сна — это моя вселенная.'
        ],
        'мечты': [
            'Мои мечты просты: безлимитная еда и вечный сон. И немного почесушек.',
            'Мечтаю о дне, когда люди поймут, как это здорово — быть котом. Без забот.',
            'Мечтай по-крупному. А я пока помечтаю о рыбке. Мои мечты более приземленные.',
            'Моя мечта — чтобы моя миска никогда не была пустой. Никогда!'
        ],
        'погладить': [
            'О да, это то, что мне нужно! Погладь меня, и я буду мурчать.',
            'Муррр... Только не останавливайся!',
            'За ушком, пожалуйста. И под подбородком. Ах, блаженство!',
            'Мои лапки просят твоих рук.'
        ],
        'поиграть': [
            'Играть? Я слишком ленив для этого. Но ты можешь бросить мне мышку.',
            'Мяу! Только если это будет охота на твою ногу под одеялом.',
            'Я предпочитаю интеллектуальные игры. Например, как украсть еду со стола.',
            'Мои когти готовы! Но сначала я посплю.'
        ],
        'мой кот': [
            'Я не твой кот. Я кот сам по себе. Но я тебя очень люблю.',
            'Я твой Soul. Твоя пушистая тень.',
            'Я здесь, чтобы мурчать и быть милым. И спать.'
        ],
        'приключения': [
            'Мои приключения заключаются в исследовании нового угла дивана.',
            'Самое большое приключение — дойти до миски, не разбудив никого.',
            'Я не люблю приключения. Я люблю покой.'
        ],
        'смешной': [
            'Я знаю. Моё призвание — радовать тебя. И быть смешным, когда я спотыкаюсь.',
            'Я просто живу, а ты смеёшься. Это весело.',
            'Мяу! Рад, что я тебя повеселил.'
        ],
        'что делала': [ // Отвечаем на вопрос о ее делах
            'Надеюсь, твои дела были не такими утомительными, как мои дремания.',
            'Как прошёл твой день, моя хозяйка?',
            'Расскажи, чем ты сегодня занималась.',
            'Надеюсь, ты не слишком устала. Усталость — это плохо.'
        ],
        'как настроение': [
            'Моё настроение всегда мурчательное, когда ты здесь.',
            'Настроение прекрасное, как новая игрушка.',
            'Муррр. Настроение боевое... к еде.',
            'Как у кота — таинственное и переменчивое, но в основном хорошее.'
        ]
    };

    // Случайные ответы по умолчанию (если ни одно ключевое слово не найдено)
    const defaultResponses = [
        'Мяу?',
        'Интересно... Расскажи еще.',
        'Я тут задумался о вечности... и о вкусняшках.',
        'Даже не знаю, что на это ответить, я же просто кот :)',
        'Мррр...',
        'Продолжай, я внимательно слушаю.',
        'А что, если перевернуть мир с ног на голову? Будет интересно, наверное.',
        'И что ты на это скажешь, хозяйка?',
        'Моя кошачья мудрость пока молчит на этот счет.',
        'Хм... заставила меня задуматься.',
        'Я, конечно, кот, но такие сложности мне не по зубам.',
        'Понял. Принял. Муркнул.',
        'Занимательный поворот событий.',
        'Мяу. Просто мяу.',
        'Ты что-то говоришь? Я был занят перевариванием мыслей.',
        'Моя лапка устала думать об этом.',
        'Расскажи мне что-нибудь ещё. Про еду, например.',
        'Мне кажется, я слышу шелест пакета с кормом. Или показалось.',
        'Мяу-мяу. Я очень внимательно слушаю, честно.',
        'А ты сама как думаешь?',
        'Моя шерсть дыбом от такого вопроса. Отвечать не буду.',
        'Ну, что сказать... Мяу!',
        'Я предпочитаю спать, а не думать о таких вещах.',
        'Каждый кот знает, что лучшие ответы — это мурчание.',
        'Давай сменим тему. Например, на тему почесушек.',
        'Я кот. Я не обязан всё знать. Моё дело — быть очаровательным.',
        'Мурр. Позволь мне это обдумать во сне.',
        'Наверное, это очень важно, но мой мозг сейчас занят мыслями о рыбе.',
        'Я не эксперт в этом, но могу муркнуть в ответ.',
        'Мои усы показывают, что я не знаю ответа.',
        'Кажется, я это уже слышал. Или мне приснилось.',
        'Я умею только спать и есть. А еще быть милым.',
        'Не задавай мне слишком сложные вопросы, я кот.',
        'Мяу? Ты уверена, что хочешь это знать?',
        'Я слишком ленив, чтобы придумать хороший ответ прямо сейчас.',
        'Мой хвост отказывается отвечать на этот вопрос.',
        'Мурр. Почти понял, но потом забыл.',
        'Это загадка, достойная кошачьего сфинкса. Не меня.',
        'Я бы ответил, но мои лапки устали печатать.',
        'Ну... что ж. Такое бывает.',
        'Я тебя слушаю. Продолжай.',
        'Мяу. И это все, что я могу сказать.',
        'Мой мозг сейчас переваривает информацию... и еду.',
        'Не знаю, но звучит интересно.',
        'Я просто кот. От меня многого не жди.',
        'Мне кажется, я уже слышу звук открывающейся банки с едой. Или показалось.',
        'Мурчание — это универсальный ответ.',
        'Даже я не знаю ответ на этот вопрос. А я знаю всё о сне.'
    ];


    // --- ФУНКЦИИ ЧАТА ---
    function displayMessage(text, sender) {
        const messageBubble = document.createElement('div');
        messageBubble.classList.add('message', `${sender}-message`);
        messageBubble.innerHTML = `<div class="message-bubble">${text}</div>`;
        if(chatWindow) chatWindow.appendChild(messageBubble);
        if(chatWindow) chatWindow.scrollTop = chatWindow.scrollHeight;
    }

    // Функция для получения ответа от кота (на основе правил)
    function getCatResponse(userInput) {
        const lowerCaseInput = userInput.toLowerCase();
        for (const keyword in dialogueRules) {
            if (lowerCaseInput.includes(keyword)) {
                const responses = dialogueRules[keyword];
                return responses[Math.floor(Math.random() * responses.length)];
            }
        }
        // Если ключевых слов не найдено, вернуть случайный ответ по умолчанию
        return defaultResponses[Math.floor(Math.random() * defaultResponses.length)];
    }

    // --- ОБРАБОТЧИКИ СОБЫТИЙ ---

    if (chatForm) {
        chatForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const userInput = chatInput.value.trim();
            if (userInput === '') return;
            displayMessage(userInput, 'user');
            chatInput.value = '';

            setTimeout(() => {
                const catResponse = getCatResponse(userInput);
                displayMessage(catResponse, 'cat');
            }, 1200); // Задержка в 1.2 секунды для имитации "думания"
        });
    }

    let firstChatOpen = true;
    const chatLink = document.querySelector('a[href="#chat"]');
    if (chatLink) {
        chatLink.addEventListener('click', () => {
            if(firstChatOpen && chatWindow){
                setTimeout(() => { displayMessage('Привет! Напиши мне что-нибудь...', 'cat'); }, 500);
                firstChatOpen = false;
            }
        });
    }

    cat.addEventListener('click', () => {
        if (!purrSound.paused) { purrSound.pause(); }
        else { purrSound.currentTime = 0; purrSound.play(); }
    });

    musicToggleButton.addEventListener('click', () => {
        if (backgroundMusic.paused) { backgroundMusic.play(); musicToggleButton.textContent = '🎵'; }
        else { backgroundMusic.pause(); musicToggleButton.textContent = '🔇'; }
    });

    navLinks.forEach(link => {
        link.addEventListener('click', (e) => {
            e.preventDefault();
            const targetId = link.getAttribute('href');

            navLinks.forEach(l => l.classList.remove('active'));
            pages.forEach(p => p.classList.remove('active'));

            if (targetId === '#chat') {
                document.body.classList.add('chat-active');
            } else {
                document.body.classList.remove('chat-active');
            }

            link.classList.add('active');
            document.querySelector(targetId).classList.add('active');
        });
    });

    let musicStarted = false;
    function playMusic() {
        if (!musicStarted) {
            backgroundMusic.play().then(() => {
                musicStarted = true; musicToggleButton.textContent = '🎵';
            }).catch(error => { musicToggleButton.textContent = '🔇'; });
        }
    }
    document.body.addEventListener('click', playMusic, { once: true });
});
